---
// src/components/Header.astro

// 路径处理逻辑
const rawBase = import.meta.env.BASE_URL;
const baseUrl = rawBase.endsWith('/') ? rawBase.slice(0, -1) : rawBase;

const getLink = (path: string) => {
    const cleanPath = path.startsWith('/') ? path.slice(1) : path;
    if (cleanPath === '') return `${baseUrl}/`;
    return `${baseUrl}/${cleanPath}`;
}
---

<header class="site-header">
    <div class="header-container">
        <div class="logo-group">
            <a href="http://www.xjtu.edu.cn" target="_blank" class="logo-link">
                <img src={getLink("assets/images/logo-xjtu.png")} alt="XJTU Logo">
            </a>

            <div class="divider"></div>

            <a href="http://iair.xjtu.edu.cn" target="_blank" class="logo-link">
                <img src={getLink("assets/images/logo-iair.png")} alt="IAIR Logo">
            </a>

            <div class="divider"></div>

            <!-- 3. 实验室 Logo (CAG) -->
            <a href={getLink("")} class="logo-link">
                <img src={getLink("assets/images/logo-cag.png")} alt="CAG Logo" class="cag-logo">
            </a>
        </div>

        <nav class="nav-menu">
            <a href={getLink("")}>Home</a>
            <a href={getLink("research")}>Research</a>
            <a href={getLink("people")}>People</a>
            <a href={getLink("publications")}>Contributions</a>
            <a href={getLink("news")}>News</a>
            <a href={getLink("facilities")}>Facilities</a>
        </nav>
    </div>
</header>

<style>
    /* Header 整体布局 */
    .site-header {
        position: absolute;
        top: 0; left: 0; width: 100%;
        height: 100px;
        z-index: 1000;
        /* 渐变背景：上深下透 */
        background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%);
        transition: background 0.3s ease;
    }

    .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 0 40px;
        height: 80px; /* 稍微增加高度容纳 Logo */
    }

    /* ✅ Logo 组核心样式：Flex 布局解决换行问题 */
    .logo-group {
        display: flex;
        align-items: center; /* 垂直居中 */
        gap: 15px; /* Logo 之间的间距 */
    }

    /* 单个 Logo 图片样式 */
    .logo-group img {
        height: 40px; /* 统一高度，防止参差不齐 */
        width: auto;  /* 宽度自适应 */
        display: block;
        opacity: 0.9;
        transition: opacity 0.3s;
    }

    .logo-group img:hover {
        opacity: 1;
    }

    /* CAG Logo 可以稍微大一点（可选） */
    .cag-logo {
        height: 48px !important; /* 稍微突出一点本实验室 */
    }

    /* 竖线分割符 */
    .divider {
        width: 1px;
        height: 30px;
        background-color: rgba(255, 255, 255, 0.4);
        margin: 0 5px;
    }

    /* 导航菜单 */
    .nav-menu {
        display: flex;
        gap: 30px;
    }

    .nav-menu a {
        color: #ffffff;
        font-family: var(--font-heading);
        font-weight: 500;
        font-size: 16px;
        text-shadow: 0 1px 3px rgba(0,0,0,0.3); /* 防止背景太亮看不清文字 */
        position: relative;
    }

    .nav-menu a:hover {
        color: var(--accent-orange);
    }

    /* 移动端适配 */
    @media (max-width: 1024px) {
        /* 平板/手机上隐藏学校 Logo，只留实验室 Logo，防止挤压 */
        .logo-group a:not(:last-child), .divider {
            display: none;
        }
        .header-container { padding: 0 20px; }
    }
    
    @media (max-width: 768px) {
        .nav-menu { display: none; } /* 同样，暂不处理汉堡菜单 */
    }
</style>
