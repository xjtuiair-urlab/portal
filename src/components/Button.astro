---
// src/components/Button.astro

interface Props {
  href: string;
  variant?: 'primary' | 'outline' | 'video' | 'stats'; // 定义4种风格
  class?: string; // 允许从外部传入额外样式
}

const { href, variant = 'primary', class: className, ...rest } = Astro.props;

// 1. 内置路径修复逻辑 (再也不用在外面写 fixPath 了！)
const rawBase = import.meta.env.BASE_URL;
const baseUrl = rawBase.endsWith('/') ? rawBase.slice(0, -1) : rawBase;

const getLink = (path: string) => {
    if (!path) return "#";
    if (path.startsWith('http')) return path;
    const cleanPath = path.startsWith('/') ? path.slice(1) : path;
    return `${baseUrl}/${cleanPath}`;
}

const finalHref = getLink(href);
---

<a href={finalHref} class:list={['btn-base', `btn-${variant}`, className]} {...rest}>
    <slot />
</a>

<style>
    /* 基础样式 (所有按钮通用) */
    .btn-base {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 30px;
        border-radius: 30px;
        font-weight: 600;
        font-family: var(--font-heading, sans-serif);
        text-decoration: none;
        transition: all 0.3s ease;
        cursor: pointer;
        font-size: 16px;
        line-height: 1;
        
        /* ✅ 强制锁死文字颜色，防止点击后变黑 */
        color: #ffffff !important; 
    }

    /* 悬停时的通用位移 */
    .btn-base:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    /* =========================
       风格 1: Primary (默认深蓝实心)
       用于: Hero, Research, Contact
       ========================= */
    .btn-primary {
        background-color: var(--primary-blue, #00338D);
        border: 2px solid var(--primary-blue, #00338D);
    }
    .btn-primary:hover {
        background-color: var(--accent-orange, #f58220);
        border-color: var(--accent-orange, #f58220);
    }

    /* =========================
       风格 2: Outline (蓝色描边，背景透明)
       用于: Publications
       ========================= */
    .btn-outline {
        background-color: transparent;
        border: 2px solid var(--primary-blue, #00338D);
        color: var(--primary-blue, #00338D) !important; /* 这里特例：默认蓝色字 */
    }
    .btn-outline:hover {
        background-color: var(--primary-blue, #00338D);
        color: #ffffff !important; /* 悬停变白字 */
    }

    /* =========================
       风格 3: Video (白色描边，半透明黑底)
       用于: Video Section (深色背景上)
       ========================= */
    .btn-video {
        background-color: rgba(0,0,0,0.3);
        border: 2px solid rgba(255,255,255,0.8);
    }
    .btn-video:hover {
        background-color: var(--primary-blue, #00338D);
        border-color: var(--primary-blue, #00338D);
    }

    /* =========================
       风格 4: Stats (白色实心/半透明)
       用于: Team Section (深色背景上)
       ========================= */
    .btn-stats {
        background-color: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.4);
        backdrop-filter: blur(5px);
    }
    .btn-stats:hover {
        background-color: var(--accent-orange, #f58220);
        border-color: var(--accent-orange, #f58220);
    }
</style>
